<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Node routing-controllers | 風之家</title>
    <meta name="description" content="我不去想身后会不会袭来寒风冷雨，既然目标是地平线，留给世界的只能是背影">
    <link rel="icon" href="/images/icons/logo_256x256.png">
  <link rel="shortcut icon" type="image/x-icon" href="/icons/favicon.ico">
  <script>
            var _hmt = _hmt || [];
            (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?ab4ebebbea4df8ea62cf5195aff6b3a2";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
            })();
        </script>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#4BB547">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/icons/logo_256x256.png">
  <link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#4BB547">
  <meta name="msapplication-TileImage" content="/images/icons/logo_256x256.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.7edc3160.css" as="style"><link rel="preload" href="/assets/js/app.5d5e6ed3.js" as="script"><link rel="preload" href="/assets/js/2.4e5ce663.js" as="script"><link rel="preload" href="/assets/js/55.15ffc253.js" as="script"><link rel="prefetch" href="/assets/js/10.aff9063f.js"><link rel="prefetch" href="/assets/js/11.83ed51e0.js"><link rel="prefetch" href="/assets/js/12.d2d8dc3b.js"><link rel="prefetch" href="/assets/js/13.8d987336.js"><link rel="prefetch" href="/assets/js/14.306491dc.js"><link rel="prefetch" href="/assets/js/15.62163e62.js"><link rel="prefetch" href="/assets/js/16.49caee36.js"><link rel="prefetch" href="/assets/js/17.82aff6e3.js"><link rel="prefetch" href="/assets/js/18.dde14342.js"><link rel="prefetch" href="/assets/js/19.f54bc248.js"><link rel="prefetch" href="/assets/js/20.a277a9fe.js"><link rel="prefetch" href="/assets/js/21.8b246d53.js"><link rel="prefetch" href="/assets/js/22.f2bb5de8.js"><link rel="prefetch" href="/assets/js/23.9a68c9ae.js"><link rel="prefetch" href="/assets/js/24.420604fd.js"><link rel="prefetch" href="/assets/js/25.98c7b762.js"><link rel="prefetch" href="/assets/js/26.e9152e1e.js"><link rel="prefetch" href="/assets/js/27.152f4691.js"><link rel="prefetch" href="/assets/js/28.c753e386.js"><link rel="prefetch" href="/assets/js/29.b70b54b1.js"><link rel="prefetch" href="/assets/js/3.dc4002b9.js"><link rel="prefetch" href="/assets/js/30.7ee45973.js"><link rel="prefetch" href="/assets/js/31.26ff61d4.js"><link rel="prefetch" href="/assets/js/32.06ffb11d.js"><link rel="prefetch" href="/assets/js/33.10e336de.js"><link rel="prefetch" href="/assets/js/34.0cef11da.js"><link rel="prefetch" href="/assets/js/35.935f9297.js"><link rel="prefetch" href="/assets/js/36.6007836f.js"><link rel="prefetch" href="/assets/js/37.1d4721c1.js"><link rel="prefetch" href="/assets/js/38.12d8bfbc.js"><link rel="prefetch" href="/assets/js/39.e786984c.js"><link rel="prefetch" href="/assets/js/4.7ca75168.js"><link rel="prefetch" href="/assets/js/40.002b28ca.js"><link rel="prefetch" href="/assets/js/41.bab4df60.js"><link rel="prefetch" href="/assets/js/42.eb29a58e.js"><link rel="prefetch" href="/assets/js/43.b55aa449.js"><link rel="prefetch" href="/assets/js/44.7d569733.js"><link rel="prefetch" href="/assets/js/45.469042a7.js"><link rel="prefetch" href="/assets/js/46.cdff955b.js"><link rel="prefetch" href="/assets/js/47.c675d045.js"><link rel="prefetch" href="/assets/js/48.bf78053b.js"><link rel="prefetch" href="/assets/js/49.f2bbca3d.js"><link rel="prefetch" href="/assets/js/5.829af56e.js"><link rel="prefetch" href="/assets/js/50.6b0fea64.js"><link rel="prefetch" href="/assets/js/51.449c9f27.js"><link rel="prefetch" href="/assets/js/52.6d7a441e.js"><link rel="prefetch" href="/assets/js/53.30104ea3.js"><link rel="prefetch" href="/assets/js/54.3fcbb579.js"><link rel="prefetch" href="/assets/js/56.63496e8d.js"><link rel="prefetch" href="/assets/js/6.1d7b7ce2.js"><link rel="prefetch" href="/assets/js/7.aa60ae50.js"><link rel="prefetch" href="/assets/js/8.860bd46a.js"><link rel="prefetch" href="/assets/js/9.0b52ab0f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7edc3160.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/icons/logo_256x256.png" alt="風之家" class="logo"> <span class="site-name can-hide">風之家</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">博客列表</a></div><div class="nav-item"><a href="/front/" class="nav-link">大前端</a></div><div class="nav-item"><a href="/resume/" class="nav-link">关于我</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于風之家</a></div> <a href="https://github.com/ruanjq/windhome" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">博客列表</a></div><div class="nav-item"><a href="/front/" class="nav-link">大前端</a></div><div class="nav-item"><a href="/resume/" class="nav-link">关于我</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于風之家</a></div> <a href="https://github.com/ruanjq/windhome" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/server" class="sidebar-heading clickable router-link-active open"><span> 服务端开发</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/server/nodejs" class="sidebar-heading clickable router-link-active open"><span> Node.js</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/server/nodejs/12306.html" class="sidebar-link"> Node.js 版 12306 抢票软件</a></li><li><a href="/server/nodejs/BFF.html" class="sidebar-link"> 前端BFF框架</a></li><li><a href="/server/nodejs/" class="sidebar-link"> Node.js</a></li><li><a href="/server/nodejs/nginxConfig.html" class="sidebar-link">/server/nodejs/nginxConfig.html</a></li><li><a href="/server/nodejs/request.html" class="sidebar-link"> node 转发接口请求</a></li><li><a href="/server/nodejs/routingControllers.html" class="active sidebar-link"> Node routing-controllers  </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#example-of-usage" class="sidebar-link">Example of usage</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#more-examples" class="sidebar-link">More examples</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#using-middlewares" class="sidebar-link">Using middlewares</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#using-interceptors" class="sidebar-link">Using interceptors</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#creating-instances-of-classes-from-action-params" class="sidebar-link">Creating instances of classes from action params</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#controller-inheritance" class="sidebar-link">Controller Inheritance</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#auto-validating-action-params" class="sidebar-link">Auto validating action params</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#using-authorization-features" class="sidebar-link">Using authorization features</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#using-di-container" class="sidebar-link">Using DI container</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#custom-parameter-decorators" class="sidebar-link">Custom parameter decorators</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#decorators-reference" class="sidebar-link">Decorators Reference</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#samples" class="sidebar-link">Samples</a></li><li class="sidebar-sub-header"><a href="/server/nodejs/routingControllers.html#release-notes" class="sidebar-link">Release notes</a></li></ul></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="table-of-contents"><a href="#table-of-contents" class="header-anchor">#</a> Table of Contents</h1> <ul><li><a href="#installation">Installation</a></li> <li><a href="#example-of-usage">Example of usage</a></li> <li><a href="#more-examples">More examples</a> <ul><li><a href="#working-with-json">Working with json</a></li> <li><a href="#return-promises">Return promises</a></li> <li><a href="#using-request-and-response-objects">Using Request and Response objects</a></li> <li><a href="#pre-configure-expresskoa">Pre-configure express/koa</a></li> <li><a href="#load-all-controllers-from-the-given-directory">Load all controllers from the given directory</a></li> <li><a href="#prefix-all-controllers-routes">Prefix all controllers routes</a></li> <li><a href="#prefix-controller-with-base-route">Prefix controller with base route</a></li> <li><a href="#inject-routing-parameters">Inject routing parameters</a></li> <li><a href="#inject-query-parameters">Inject query parameters</a></li> <li><a href="#inject-request-body">Inject request body</a></li> <li><a href="#inject-request-body-parameters">Inject request body parameters</a></li> <li><a href="#inject-request-header-parameters">Inject request header parameters</a></li> <li><a href="#inject-cookie-parameters">Inject cookie parameters</a></li> <li><a href="#inject-session-object">Inject session object</a></li> <li><a href="#inject-state-object">Inject state object</a></li> <li><a href="#inject-uploaded-file">Inject uploaded file</a></li> <li><a href="#make-parameter-required">Make parameter required</a></li> <li><a href="#convert-parameters-to-objects">Convert parameters to objects</a></li> <li><a href="#set-custom-contenttype">Set custom ContentType</a></li> <li><a href="#set-location">Set Location</a></li> <li><a href="#set-redirect">Set Redirect</a></li> <li><a href="#set-custom-http-code">Set custom HTTP code</a></li> <li><a href="#controlling-empty-responses">Controlling empty responses</a></li> <li><a href="#set-custom-headers">Set custom headers</a></li> <li><a href="#render-templates">Render templates</a></li> <li><a href="#throw-http-errors">Throw HTTP errors</a></li> <li><a href="#enable-cors">Enable CORS</a></li> <li><a href="#default-settings">Default settings</a></li> <li><a href="#selectively-disable-requestresponse-transforming">Selectively disabling request/response transform</a></li></ul></li> <li><a href="#using-middlewares">Using middlewares</a> <ul><li><a href="#use-exist-middleware">Use exist middleware</a></li> <li><a href="#creating-your-own-express-middleware">Creating your own express middleware</a></li> <li><a href="#creating-your-own-koa-middleware">Creating your own koa middleware</a></li> <li><a href="#global-middlewares">Global middlewares</a></li> <li><a href="#error-handlers">Error handlers</a></li> <li><a href="#loading-middlewares-and-controllers-from-directories">Loading middlewares and controllers from directories</a></li></ul></li> <li><a href="#using-interceptors">Using interceptors</a> <ul><li><a href="#interceptor-function">Interceptor function</a></li> <li><a href="#interceptor-classes">Interceptor classes</a></li> <li><a href="#global-interceptors">Global interceptors</a></li></ul></li> <li><a href="#creating-instances-of-classes-from-action-params">Creating instances of classes from action params</a></li> <li><a href="#controller-inheritance">Controller inheritance</a></li> <li><a href="#auto-validating-action-params">Auto validating action params</a></li> <li><a href="#using-authorization-features">Using authorization features</a> <ul><li><a href="#authorized-decorator">@Authorized decorator</a></li> <li><a href="#currentuser-decorator">@CurrentUser decorator</a></li></ul></li> <li><a href="#using-di-container">Using DI container</a></li> <li><a href="#custom-parameter-decorators">Custom parameter decorators</a></li> <li><a href="#decorators-reference">Decorators Reference</a> <ul><li><a href="#controller-decorators">Controller Decorators</a></li> <li><a href="#controller-method-decorators">Controller Method Decorators</a></li> <li><a href="#method-parameter-decorators">Method Parameter Decorators</a></li> <li><a href="#middleware-and-interceptor-decorators">Middleware And Interceptor Decorators</a></li> <li><a href="#other-decorators">Other Decorators</a></li></ul></li> <li><a href="#samples">Samples</a></li> <li><a href="#release-notes">Release notes</a></li></ul> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <ol><li><p>Install module:</p> <p><code>npm install routing-controllers</code></p></li> <li><p><code>reflect-metadata</code> shim is required:</p> <p><code>npm install reflect-metadata</code></p> <p>and make sure to import it before you use routing-controllers:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>Install framework:</p> <p><strong>a. If you want to use routing-controllers with <em>express.js</em>, then install it and all required dependencies:</strong></p> <p><code>npm install express body-parser multer</code></p> <p>Optionally you can also install their typings:</p> <p><code>npm install -D @types/express @types/body-parser @types/multer</code></p> <p><strong>b. If you want to use routing-controllers with <em>koa 2</em>, then install it and all required dependencies:</strong></p> <p><code>npm install koa koa-router koa-bodyparser koa-multer</code></p> <p>Optionally you can also install their typings:</p> <p><code>npm install -D @types/koa @types/koa-router @types/koa-bodyparser</code></p></li> <li><p>Install peer dependencies:</p></li></ol> <p><code>npm install class-transformer class-validator</code></p> <p>In prior versions, these were direct dependencies, but now they are peer dependencies so you can choose when to upgrade and accept breaking changes.</p> <ol start="5"><li><p>Its important to set these options in <code>tsconfig.json</code> file of your project:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;emitDecoratorMetadata&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">&quot;experimentalDecorators&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="example-of-usage"><a href="#example-of-usage" class="header-anchor">#</a> Example of usage</h2> <ol><li><p>Create a file <code>UserController.ts</code></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Param<span class="token punctuation">,</span> Body<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Put<span class="token punctuation">,</span> Delete <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token string">&quot;This action returns all users&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token string">&quot;This action returns user #&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token string">&quot;Saving user...&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">put</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token string">&quot;Updating a user...&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">remove</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token string">&quot;Removing user...&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>This class will register routes specified in method decorators in your server framework (express.js or koa).</p></li> <li><p>Create a file <code>app.ts</code></p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span> <span class="token comment">// this shim is required</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./UserController&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// creates express app, registers all controller routes and returns you express app instance</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span> <span class="token comment">// we specify controllers we want to use</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// run express application on port 3000</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>if you are koa user you just need to use <code>createKoaServer</code> instead of <code>createExpressServer</code></p></blockquote></li> <li><p>Open in browser <code>http://localhost:3000/users</code>. You will see <code>This action returns all users</code> in your browser.
If you open <code>http://localhost:3000/users/1</code> you will see <code>This action returns user #1</code>.</p></li></ol> <h2 id="more-examples"><a href="#more-examples" class="header-anchor">#</a> More examples</h2> <h4 id="working-with-json"><a href="#working-with-json" class="header-anchor">#</a> Working with json</h4> <p>If you are designing a REST API where your endpoints always receive and return JSON then
you can use <code>@JsonController</code> decorator instead of <code>@Controller</code>.
This will guarantee you that data returned by your controller actions always be transformed to JSON
and <code>Content-Type</code> header will be always set to <code>application/json</code>.
It will also guarantee <code>application/json</code> header is understood from the requests and the body parsed as JSON:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> JsonController<span class="token punctuation">,</span> Param<span class="token punctuation">,</span> Body<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Put<span class="token punctuation">,</span> Delete <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">JsonController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="return-promises"><a href="#return-promises" class="header-anchor">#</a> Return promises</h4> <p>You can return a promise in the controller, and it will wait until promise resolved and return promise result in a response body.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> JsonController<span class="token punctuation">,</span> Param<span class="token punctuation">,</span> Body<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Put<span class="token punctuation">,</span> Delete <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">JsonController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">put</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
    <span class="token function">remove</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">removeById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="using-request-and-response-objects"><a href="#using-request-and-response-objects" class="header-anchor">#</a> Using Request and Response objects</h4> <p>You can use framework's request and response objects directly. If you want to handle the response by yourself,
just make sure you return the response object itself from the action.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Req<span class="token punctuation">,</span> Res<span class="token punctuation">,</span> Get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Req</span><span class="token punctuation">(</span><span class="token punctuation">)</span> request<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> @<span class="token function">Res</span><span class="token punctuation">(</span><span class="token punctuation">)</span> response<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;Hello response!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getAllPosts</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Req</span><span class="token punctuation">(</span><span class="token punctuation">)</span> request<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> @<span class="token function">Res</span><span class="token punctuation">(</span><span class="token punctuation">)</span> response<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// some response functions don't return the response object,</span>
        <span class="token comment">// so it needs to be returned explicitly</span>
        response<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> response<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p><code>@Req()</code> decorator injects you a <code>Request</code> object, and <code>@Res()</code> decorator injects you a <code>Response</code> object.
If you have installed typings, you can use their types:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Request<span class="token punctuation">,</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Req<span class="token punctuation">,</span> Res<span class="token punctuation">,</span> Get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Req</span><span class="token punctuation">(</span><span class="token punctuation">)</span> request<span class="token punctuation">:</span> Request<span class="token punctuation">,</span> @<span class="token function">Res</span><span class="token punctuation">(</span><span class="token punctuation">)</span> response<span class="token punctuation">:</span> Response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;Hello response!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>note: koa users can also use <code>@Ctx() context</code> to inject koa's Context object.</p></blockquote> <h4 id="pre-configure-express-koa"><a href="#pre-configure-express-koa" class="header-anchor">#</a> Pre-configure express/koa</h4> <p>If you have, or if you want to create and configure express app separately,
you can use <code>useExpressServer</code> instead of <code>createExpressServer</code> function:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> express <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// or you can import it if you have installed typings</span>
<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// your created express server</span>
<span class="token comment">// app.use() // you can configure it the way you want</span>
<span class="token function">useExpressServer</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// register created express server in routing-controllers</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span> <span class="token comment">// and configure it the way you need (controllers, validation, etc.)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// run your express server</span>
</code></pre></div><blockquote><p>koa users must use <code>useKoaServer</code> instead of <code>useExpressServer</code></p></blockquote> <h4 id="load-all-controllers-from-the-given-directory"><a href="#load-all-controllers-from-the-given-directory" class="header-anchor">#</a> Load all controllers from the given directory</h4> <p>You can load all controllers from directories, by specifying array of directories in options of
<code>createExpressServer</code> or <code>useExpressServer</code>:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/controllers/*.js&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// register controllers routes in our express application</span>
</code></pre></div><blockquote><p>koa users must use <code>createKoaServer</code> instead of <code>createExpressServer</code></p></blockquote> <h4 id="prefix-all-controllers-routes"><a href="#prefix-all-controllers-routes" class="header-anchor">#</a> Prefix all controllers routes</h4> <p>If you want to prefix all your routes, e.g. <code>/api</code> you can use  <code>routePrefix</code> option:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./controller/UserController&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    routePrefix<span class="token punctuation">:</span> <span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>koa users must use <code>createKoaServer</code> instead of <code>createExpressServer</code></p></blockquote> <h4 id="prefix-controller-with-base-route"><a href="#prefix-controller-with-base-route" class="header-anchor">#</a> Prefix controller with base route</h4> <p>You can prefix all specific controller's actions with base route:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="inject-routing-parameters"><a href="#inject-routing-parameters" class="header-anchor">#</a> Inject routing parameters</h4> <p>You can use <code>@Param</code> decorator to inject parameters in your controller actions:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// id will be automatically casted to &quot;number&quot; because it has type number</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you want to inject all parameters use <code>@Params()</code> decorator.</p> <h4 id="inject-query-parameters"><a href="#inject-query-parameters" class="header-anchor">#</a> Inject query parameters</h4> <p>To inject query parameters, use <code>@QueryParam</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span>@<span class="token function">QueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;limit&quot;</span><span class="token punctuation">)</span> limit<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you want to inject all query parameters use <code>@QueryParams()</code> decorator.
The bigest benefit of this approach is that you can perform validation of the params.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">enum</span> Roles <span class="token punctuation">{</span>
    Admin <span class="token operator">=</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
    User <span class="token operator">=</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span>
    Guest <span class="token operator">=</span> <span class="token string">&quot;guest&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">GetUsersQuery</span> <span class="token punctuation">{</span>

    @<span class="token function">IsPositive</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    limit<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

    @<span class="token function">IsAlpha</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    city<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    @<span class="token function">IsEnum</span><span class="token punctuation">(</span>Roles<span class="token punctuation">)</span>
    role<span class="token punctuation">:</span> Roles<span class="token punctuation">;</span>

    @<span class="token function">IsBoolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    isActive<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">QueryParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span> query<span class="token punctuation">:</span> GetUsersQuery</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// here you can access query.role, query.limit</span>
    <span class="token comment">// and others valid query parameters</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="inject-request-body"><a href="#inject-request-body" class="header-anchor">#</a> Inject request body</h4> <p>To inject request body, use <code>@Body</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">saveUser</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you specify a class type to parameter that is decorated with <code>@Body()</code>,
routing-controllers will use <a href="https://github.com/typestack/class-transformer" target="_blank" rel="noopener noreferrer">class-transformer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to create instance of the given class type from the data received in request body.
To disable this behaviour you need to specify a <code>{ classTransformer: false }</code> in RoutingControllerOptions when creating a server.</p> <h4 id="inject-request-body-parameters"><a href="#inject-request-body-parameters" class="header-anchor">#</a> Inject request body parameters</h4> <p>To inject request body parameter, use <code>@BodyParam</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">saveUser</span><span class="token punctuation">(</span>@<span class="token function">BodyParam</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> userName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="inject-request-header-parameters"><a href="#inject-request-header-parameters" class="header-anchor">#</a> Inject request header parameters</h4> <p>To inject request header parameter, use <code>@HeaderParam</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">saveUser</span><span class="token punctuation">(</span>@<span class="token function">HeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">)</span> token<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you want to inject all header parameters use <code>@HeaderParams()</code> decorator.</p> <h4 id="inject-cookie-parameters"><a href="#inject-cookie-parameters" class="header-anchor">#</a> Inject cookie parameters</h4> <p>To get a cookie parameter, use <code>@CookieParam</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span>@<span class="token function">CookieParam</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span> username<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you want to inject all header parameters use <code>@CookieParams()</code> decorator.</p> <h4 id="inject-session-object"><a href="#inject-session-object" class="header-anchor">#</a> Inject session object</h4> <p>To inject a session value, use <code>@SessionParam</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
<span class="token function">savePost</span><span class="token punctuation">(</span>@<span class="token function">SessionParam</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> post<span class="token punctuation">:</span> Post<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>If you want to inject the main session object, use <code>@Session()</code> without any parameters.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
<span class="token function">savePost</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Session</span><span class="token punctuation">(</span><span class="token punctuation">)</span> session<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> post<span class="token punctuation">:</span> Post</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>The parameter marked with <code>@Session</code> decorator is required by default. If your action param is optional, you have to mark it as not required:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">action</span><span class="token punctuation">(</span>@<span class="token function">Session</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> required<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>Express uses <a href="https://www.npmjs.com/package/express-session" target="_blank" rel="noopener noreferrer">express-session<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> / Koa uses <a href="https://www.npmjs.com/package/koa-session" target="_blank" rel="noopener noreferrer">koa-session<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or <a href="https://www.npmjs.com/package/koa-generic-session" target="_blank" rel="noopener noreferrer">koa-generic-session<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to handle session, so firstly you have to install it manually to use <code>@Session</code> decorator.</p> <h4 id="inject-state-object"><a href="#inject-state-object" class="header-anchor">#</a> Inject state object</h4> <p>To inject a state parameter use <code>@State</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
<span class="token function">savePost</span><span class="token punctuation">(</span>@<span class="token function">State</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> post<span class="token punctuation">:</span> Post<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you want to inject the whole state object use <code>@State()</code> without any parameters.
This feature is only supported by Koa.</p> <h4 id="inject-uploaded-file"><a href="#inject-uploaded-file" class="header-anchor">#</a> Inject uploaded file</h4> <p>To inject uploaded file, use <code>@UploadedFile</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/files&quot;</span><span class="token punctuation">)</span>
<span class="token function">saveFile</span><span class="token punctuation">(</span>@<span class="token function">UploadedFile</span><span class="token punctuation">(</span><span class="token string">&quot;fileName&quot;</span><span class="token punctuation">)</span> file<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can also specify uploading options to multer this way:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// to keep code clean better to extract this function into separate file</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">fileUploadOptions</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    storage<span class="token punctuation">:</span> multer<span class="token punctuation">.</span><span class="token function">diskStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">destination</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> file<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> cb<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">filename</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> file<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> cb<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fileFilter</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> file<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> cb<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    limits<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        fieldNameSize<span class="token punctuation">:</span> <span class="token number">255</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// use options this way:</span>
@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/files&quot;</span><span class="token punctuation">)</span>
<span class="token function">saveFile</span><span class="token punctuation">(</span>@<span class="token function">UploadedFile</span><span class="token punctuation">(</span><span class="token string">&quot;fileName&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> options<span class="token punctuation">:</span> fileUploadOptions <span class="token punctuation">}</span><span class="token punctuation">)</span> file<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To inject all uploaded files use <code>@UploadedFiles</code> decorator instead.
Routing-controllers uses <a href="https://github.com/expressjs/multer" target="_blank" rel="noopener noreferrer">multer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to handle file uploads.
You can install multer's file definitions via typings, and use <code>files: File[]</code> type instead of <code>any[]</code>.</p> <h4 id="make-parameter-required"><a href="#make-parameter-required" class="header-anchor">#</a> Make parameter required</h4> <p>To make any parameter required, simply pass a <code>required: true</code> flag in its options:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// your method will not be executed if user is not sent in a request</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Same you can do with all other parameters <code>@QueryParam</code>, <code>@BodyParam</code> and others.
If user request does not contain required parameter routing-controllers will throw an error.</p> <h4 id="convert-parameters-to-objects"><a href="#convert-parameters-to-objects" class="header-anchor">#</a> Convert parameters to objects</h4> <p>If you specify a class type to parameter that is decorated with parameter decorator,
routing-controllers will use <a href="https://github.com/typestack/class-transformer" target="_blank" rel="noopener noreferrer">class-transformer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to create instance of that class type.
More info about this feature is available <a href="#creating-instances-of-classes-from-action-params">here</a>.</p> <h4 id="set-custom-contenttype"><a href="#set-custom-contenttype" class="header-anchor">#</a> Set custom ContentType</h4> <p>You can specify a custom ContentType header:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">ContentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/csv&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="set-location"><a href="#set-location" class="header-anchor">#</a> Set Location</h4> <p>You can set a Location header for any action:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">Location</span><span class="token punctuation">(</span><span class="token string">&quot;http://github.com&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="set-redirect"><a href="#set-redirect" class="header-anchor">#</a> Set Redirect</h4> <p>You can set a Redirect header for any action:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;http://github.com&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can override the Redirect header by returning a string value:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;http://github.com&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;https://www.google.com&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can use template to generate the Redirect header:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">Redirect</span><span class="token punctuation">(</span><span class="token string">&quot;http://github.com/:owner/:repo&quot;</span><span class="token punctuation">)</span>
<span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        owner<span class="token punctuation">:</span> <span class="token string">&quot;typestack&quot;</span><span class="token punctuation">,</span>
        repo<span class="token punctuation">:</span> <span class="token string">&quot;routing-controllers&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="set-custom-http-code"><a href="#set-custom-http-code" class="header-anchor">#</a> Set custom HTTP code</h4> <p>You can explicitly set a returned HTTP code for any action:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">HttpCode</span><span class="token punctuation">(</span><span class="token number">201</span><span class="token punctuation">)</span>
@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
<span class="token function">saveUser</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="controlling-empty-responses"><a href="#controlling-empty-responses" class="header-anchor">#</a> Controlling empty responses</h4> <p>If your controller returns <code>void</code> or <code>Promise&lt;void&gt;</code> or <code>undefined</code> it will throw you 404 error.
To prevent this if you need to specify what status code you want to return using <code>@OnUndefined</code> decorator.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">OnUndefined</span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">remove</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">removeById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@OnUndefined</code> is also useful when you return some object which can or cannot be undefined.
In this example <code>findOneById</code> returns undefined in the case if user with given id was not found.
This action will return 404 in the case if user was not found, and regular 200 in the case if it was found.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">OnUndefined</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findOneById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can also specify error class you want to use if it returned undefined:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> HttpError <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserNotFoundError</span> <span class="token keyword">extends</span> <span class="token class-name">HttpError</span> <span class="token punctuation">{</span>
    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token string">&quot;User not found!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">OnUndefined</span><span class="token punctuation">(</span>UserNotFoundError<span class="token punctuation">)</span>
<span class="token function">saveUser</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> userRepository<span class="token punctuation">.</span><span class="token function">findOneById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If controller action returns <code>null</code> you can use <code>@OnNull</code> decorator instead.</p> <h4 id="set-custom-headers"><a href="#set-custom-headers" class="header-anchor">#</a> Set custom headers</h4> <p>You can set any custom header in a response:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">Header</span><span class="token punctuation">(</span><span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="render-templates"><a href="#render-templates" class="header-anchor">#</a> Render templates</h4> <p>If you are using server-side rendering you can render any template:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">Render</span><span class="token punctuation">(</span><span class="token string">&quot;index.html&quot;</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        param1<span class="token punctuation">:</span> <span class="token string">&quot;these params are used&quot;</span><span class="token punctuation">,</span>
        param2<span class="token punctuation">:</span> <span class="token string">&quot;in templating engine&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To use rendering ability make sure to configure express / koa properly.
To use rendering ability with Koa you will need to use a rendering 3rd party such as <a href="https://github.com/queckezz/koa-views/" target="_blank" rel="noopener noreferrer">koa-views<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>,
koa-views is the only render middleware that has been tested.</p> <h4 id="throw-http-errors"><a href="#throw-http-errors" class="header-anchor">#</a> Throw HTTP errors</h4> <p>If you want to return errors with specific error codes, there is an easy way:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userRepository<span class="token punctuation">.</span><span class="token function">findOneById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>user<span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NotFoundError</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">User was not found.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// message is optional</span>

    <span class="token keyword">return</span> user<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now, when user won't be found with requested id, response will be with http status code 404 and following content:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NotFoundError&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;User was not found.&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>There are set of prepared errors you can use:</p> <ul><li>HttpError</li> <li>BadRequestError</li> <li>ForbiddenError</li> <li>InternalServerError</li> <li>MethodNotAllowedError</li> <li>NotAcceptableError</li> <li>NotFoundError</li> <li>UnauthorizedError</li></ul> <p>You can also create and use your own errors by extending <code>HttpError</code> class.
To define the data returned to the client, you could define a toJSON method in your error.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">DbError</span> <span class="token keyword">extends</span> <span class="token class-name">HttpError</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> operationName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> args<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter">operationName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> args<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token class-name">DbError</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>operationName <span class="token operator">=</span> operationName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>args <span class="token operator">=</span> args<span class="token punctuation">;</span> <span class="token comment">// can be used for internal logging</span>
    <span class="token punctuation">}</span>

    <span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            status<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>httpCode<span class="token punctuation">,</span>
            failedOperation<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>operationName
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="enable-cors"><a href="#enable-cors" class="header-anchor">#</a> Enable CORS</h4> <p>Since CORS is a feature that is used almost in any web-api application,
you can enable it in routing-controllers options.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./UserController&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    cors<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To use cors you need to install its module.
For express its <code>npm i cors</code>, for koa its <code>npm i kcors</code>.
You can pass cors options as well:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./UserController&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    cors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// options from cors documentation</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="default-settings"><a href="#default-settings" class="header-anchor">#</a> Default settings</h4> <p>You can override default status code in routing-controllers options.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./UserController&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    defaults<span class="token punctuation">:</span> <span class="token punctuation">{</span>

        <span class="token comment">//with this option, null will return 404 by default</span>
        nullResultCode<span class="token punctuation">:</span> <span class="token number">404</span><span class="token punctuation">,</span>

        <span class="token comment">//with this option, void or Promise&lt;void&gt; will return 204 by default</span>
        undefinedResultCode<span class="token punctuation">:</span> <span class="token number">204</span><span class="token punctuation">,</span>

        paramOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token comment">//with this option, argument will be required by default</span>
            required<span class="token punctuation">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="selectively-disable-request-response-transform"><a href="#selectively-disable-request-response-transform" class="header-anchor">#</a> Selectively disable request/response transform</h4> <p>To disable <code>class-transformer</code> on a per-controller or per-route basis, use the <code>transformRequest</code> and <code>transformResponse</code> options on your controller and route decorators:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>transformRequest<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> transformResponse<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>transformResponse<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// route option overrides controller option</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="using-middlewares"><a href="#using-middlewares" class="header-anchor">#</a> Using middlewares</h2> <p>You can use any existing express / koa middleware, or create your own.
To create your middlewares there is a <code>@Middleware</code> decorator,
and to use already exist middlewares there are <code>@UseBefore</code> and <code>@UseAfter</code> decorators.</p> <h3 id="use-existing-middleware"><a href="#use-existing-middleware" class="header-anchor">#</a> Use existing middleware</h3> <p>There are multiple ways to use middleware.
For example, lets try to use <a href="https://github.com/expressjs/compression" target="_blank" rel="noopener noreferrer">compression<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> middleware:</p> <ol><li><p>Install compression middleware: <code>npm install compression</code></p></li> <li><p>To use middleware per-action:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> UseBefore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> compression <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;compression&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>

@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">UseBefore</span><span class="token punctuation">(</span><span class="token function">compression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This way compression middleware will be applied only for <code>getOne</code> controller action,
and will be executed <em>before</em> action execution.
To execute middleware <em>after</em> action use <code>@UseAfter</code> decorator instead.</p></li> <li><p>To use middleware per-controller:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> UseBefore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> compression <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;compression&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">UseBefore</span><span class="token punctuation">(</span><span class="token function">compression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>This way compression middleware will be applied for all actions of the <code>UserController</code> controller,
and will be executed <em>before</em> its action execution. Same way you can use <code>@UseAfter</code> decorator here.</p></li> <li><p>If you want to use compression module globally for all controllers you can simply register it during bootstrap:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./UserController&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// we need to &quot;load&quot; our controller before call createExpressServer. this is required</span>
<span class="token keyword">let</span> compression <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;compression&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// creates express app, registers all controller routes and returns you express app instance</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">compression</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// run express application</span>
</code></pre></div><p>Alternatively, you can create a custom <a href="#global-middlewares">global middleware</a> and simply delegate its execution to the compression module.</p></li></ol> <h3 id="creating-your-own-express-middleware"><a href="#creating-your-own-express-middleware" class="header-anchor">#</a> Creating your own express middleware</h3> <p>Here is example of creating middleware for express.js:</p> <ol><li><p>There are two ways of creating middleware:</p> <p>First, you can create a simple middleware function:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">loggingMiddleware</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> response<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> next<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Second you can create a class:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ExpressMiddlewareInterface <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">ExpressMiddlewareInterface</span> <span class="token punctuation">{</span> <span class="token comment">// interface implementation is optional</span>

    <span class="token function">use</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> response<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> next<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Then you can use them this way:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> UseBefore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./MyMiddleware&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> loggingMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./loggingMiddleware&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">UseBefore</span><span class="token punctuation">(</span>MyMiddleware<span class="token punctuation">)</span>
@<span class="token function">UseAfter</span><span class="token punctuation">(</span>loggingMiddleware<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>or per-action:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">UseBefore</span><span class="token punctuation">(</span>MyMiddleware<span class="token punctuation">)</span>
@<span class="token function">UseAfter</span><span class="token punctuation">(</span>loggingMiddleware<span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@UseBefore</code> executes middleware before controller action.
<code>@UseAfter</code> executes middleware after each controller action.</p></li></ol> <h3 id="creating-your-own-koa-middleware"><a href="#creating-your-own-koa-middleware" class="header-anchor">#</a> Creating your own koa middleware</h3> <p>Here is example of creating middleware for koa.js:</p> <ol><li><p>There are two ways of creating middleware:</p> <p>First, you can create a simple middleware function:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">use</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something before execution...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something after execution&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error handling is also here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Second you can create a class:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> KoaMiddlewareInterface <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">KoaMiddlewareInterface</span> <span class="token punctuation">{</span> <span class="token comment">// interface implementation is optional</span>

    <span class="token function">use</span><span class="token punctuation">(</span>context<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something before execution...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something after execution&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;error handling is also here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>Then you can them this way:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> UseBefore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MyMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./MyMiddleware&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> loggingMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./loggingMiddleware&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">UseBefore</span><span class="token punctuation">(</span>MyMiddleware<span class="token punctuation">)</span>
@<span class="token function">UseAfter</span><span class="token punctuation">(</span>loggingMiddleware<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>or per-action:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users/:id&quot;</span><span class="token punctuation">)</span>
@<span class="token function">UseBefore</span><span class="token punctuation">(</span>MyMiddleware<span class="token punctuation">)</span>
@<span class="token function">UseAfter</span><span class="token punctuation">(</span>loggingMiddleware<span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@UseBefore</code> executes middleware before controller action.
<code>@UseAfter</code> executes middleware after each controller action.</p></li></ol> <h3 id="global-middlewares"><a href="#global-middlewares" class="header-anchor">#</a> Global middlewares</h3> <p>Global middlewares run before each request, always.
To make your middleware global mark it with <code>@Middleware</code> decorator and specify if it runs after or before controllers actions.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Middleware<span class="token punctuation">,</span> ExpressMiddlewareInterface <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Middleware</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token punctuation">:</span> <span class="token string">&quot;before&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoggingMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">ExpressMiddlewareInterface</span> <span class="token punctuation">{</span>

    <span class="token function">use</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> response<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>To enable this middleware, specify it during routing-controllers initialization:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./UserController&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LoggingMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./LoggingMiddleware&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>UserController<span class="token punctuation">]</span><span class="token punctuation">,</span>
   middlewares<span class="token punctuation">:</span> <span class="token punctuation">[</span>LoggingMiddleware<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="error-handlers"><a href="#error-handlers" class="header-anchor">#</a> Error handlers</h3> <p>Error handlers are specific only to express.
Error handlers work same way as middlewares, but implement <code>ExpressErrorMiddlewareInterface</code>:</p> <ol><li><p>Create a class that implements the <code>ErrorMiddlewareInterface</code> interface:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Middleware<span class="token punctuation">,</span> ExpressErrorMiddlewareInterface <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Middleware</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token punctuation">:</span> <span class="token string">&quot;after&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CustomErrorHandler</span> <span class="token keyword">implements</span> <span class="token class-name">ExpressErrorMiddlewareInterface</span> <span class="token punctuation">{</span>

    <span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> request<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> response<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token function-variable function">next</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;do something...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></li></ol> <p>Custom error handlers are invoked after the default error handler, so you won't be able to change response code or headers.
To prevent this, you have to disable default error handler by specifying <code>defaultErrorHandler</code> option in createExpressServer or useExpressServer:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    defaultErrorHandler<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token comment">// disable default error handler, only if you have your own error handler</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="loading-middlewares-interceptors-and-controllers-from-directories"><a href="#loading-middlewares-interceptors-and-controllers-from-directories" class="header-anchor">#</a> Loading middlewares, interceptors and controllers from directories</h3> <p>Also you can load middlewares from directories. Also you can use glob patterns:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/controllers/**/*.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    middlewares<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/middlewares/**/*.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    interceptors<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/interceptors/**/*.js&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="using-interceptors"><a href="#using-interceptors" class="header-anchor">#</a> Using interceptors</h2> <p>Interceptors are used to change or replace the data returned to the client.
You can create your own interceptor class or function and use to all or specific controller or controller action.
It works pretty much the same as middlewares.</p> <h3 id="interceptor-function"><a href="#interceptor-function" class="header-anchor">#</a> Interceptor function</h3> <p>The easiest way is to use functions directly passed to <code>@UseInterceptor</code> of the action.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Get<span class="token punctuation">,</span> Param<span class="token punctuation">,</span> UseInterceptor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>

@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">UseInterceptor</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">:</span> Action<span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// here you have content returned by this action. you can replace something</span>
    <span class="token comment">// in it and return a replaced result. replaced result will be returned to the user</span>
    <span class="token keyword">return</span> content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/Mike/gi</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, I am Mike!&quot;</span><span class="token punctuation">;</span> <span class="token comment">// client will get a &quot;Hello, I am Michael!&quot; response.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can use <code>@UseInterceptor</code> per-action, or per-controller.
If its used per-controller then interceptor will apply to all controller actions.</p> <h3 id="interceptor-classes"><a href="#interceptor-classes" class="header-anchor">#</a> Interceptor classes</h3> <p>You can also create a class and use it with <code>@UseInterceptor</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Interceptor<span class="token punctuation">,</span> InterceptorInterface<span class="token punctuation">,</span> Action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">NameCorrectionInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">InterceptorInterface</span> <span class="token punctuation">{</span>

    <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">:</span> Action<span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/Mike/gi</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>And use it in your controllers this way:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Get<span class="token punctuation">,</span> Param<span class="token punctuation">,</span> UseInterceptor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> NameCorrectionInterceptor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./NameCorrectionInterceptor&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>

@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/users&quot;</span><span class="token punctuation">)</span>
@<span class="token function">UseInterceptor</span><span class="token punctuation">(</span>NameCorrectionInterceptor<span class="token punctuation">)</span>
<span class="token function">getOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, I am Mike!&quot;</span><span class="token punctuation">;</span> <span class="token comment">// client will get a &quot;Hello, I am Michael!&quot; response.</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="global-interceptors"><a href="#global-interceptors" class="header-anchor">#</a> Global interceptors</h3> <p>You can create interceptors that will affect all controllers in your project by creating interceptor class
and mark it with <code>@Interceptor</code> decorator:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Interceptor<span class="token punctuation">,</span> InterceptorInterface<span class="token punctuation">,</span> Action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

@<span class="token function">Interceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">NameCorrectionInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">InterceptorInterface</span> <span class="token punctuation">{</span>

    <span class="token function">intercept</span><span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">:</span> Action<span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/Mike/gi</span><span class="token punctuation">,</span> <span class="token string">&quot;Michael&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="creating-instances-of-classes-from-action-params"><a href="#creating-instances-of-classes-from-action-params" class="header-anchor">#</a> Creating instances of classes from action params</h2> <p>When user sends a json object and you are parsing it, sometimes you want to parse it into object of some class, instead of parsing it into simple literal object.
You have ability to do this using <a href="https://github.com/typestack/class-transformer" target="_blank" rel="noopener noreferrer">class-transformer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
To use it simply specify a <code>classTransformer: true</code> option on application bootstrap:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    classTransformer<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now, when you parse your action params, if you have specified a class, routing-controllers will create you a class
of that instance with the data sent by a user:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    firstName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    lastName<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;saving user &quot;</span> <span class="token operator">+</span> user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>If <code>User</code> is an interface - then simple literal object will be created.
If its a class - then instance of this class will be created.</p> <p>This technique works with <code>@Body</code>, <code>@Param</code>, <code>@QueryParam</code>, <code>@BodyParam</code>, and other decorators.
Learn more about class-transformer and how to handle more complex object constructions <a href="https://github.com/typestack/class-transformer" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
This behaviour is enabled by default.
If you want to disable it simply pass <code>classTransformer: false</code> to createExpressServer method. Alternatively you can disable transforming for <a href="#selectively-disable-requestresponse-transforming">individual controllers or routes</a>.</p> <h2 id="controller-inheritance"><a href="#controller-inheritance" class="header-anchor">#</a> Controller Inheritance</h2> <p>Often your application may need to have an option to inherit controller from another to reuse code and void duplication.
A good example of the use is the CRUD operations which can be hidden inside <code>AbstractBaseController</code> with the possibility to add new and overload methods, the template method pattern.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/product</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">ProductController</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractControllerTemplate</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/category</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">CategoryController</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractControllerTemplate</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractControllerTemplate</span> <span class="token punctuation">{</span>
    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    @<span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    @<span class="token function">Put</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    @<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>https://en.wikipedia.org/wiki/Template_method_pattern</p> <h2 id="auto-validating-action-params"><a href="#auto-validating-action-params" class="header-anchor">#</a> Auto validating action params</h2> <p>Sometimes parsing a json object into instance of some class is not enough.
E.g. <code>class-transformer</code> doesn't check whether the property's types are correct, so you can get runtime error if you rely on TypeScript type safe. Also you may want to validate the object to check e.g. whether the password string is long enough or entered e-mail is correct.</p> <p>It can be done easily thanks to integration with <a href="https://github.com/typestack/class-validator" target="_blank" rel="noopener noreferrer">class-validator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. This behaviour is <strong>enabled</strong> by default. If you want to disable it, you need to do it explicitly e.g. by passing <code>validation: false</code> option on application bootstrap:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    validation<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you want to turn on the validation only for some params, not globally for every parameter, you can do this locally by setting <code>validate: true</code> option in parameter decorator options object:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
<span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">{</span> validate<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>Now you need to define the class which type will be used as type of controller's method param.
Decorate the properties with appropriate validation decorators.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    @<span class="token function">IsEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    email<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    @<span class="token function">MinLength</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    password<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>If you haven't used class-validator yet, you can learn how to use the decorators and handle more complex object validation <a href="https://github.com/typestack/class-validator" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Now, if you have specified a class type, your action params will be not only an instance of that class (with the data sent by a user) but they will be validated too, so you don't have to worry about eg. incorrect e-mail or too short password and manual checks every property in controller method body.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
    <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>email<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is for 100% sure a valid e-mail address!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>password<span class="token punctuation">.</span>length<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is for 100% sure 6 chars or more!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>If the param doesn't satisfy the requirements defined by class-validator decorators,
an error will be thrown and captured by routing-controller, so the client will receive 400 Bad Request and JSON with nice detailed <a href="https://github.com/typestack/class-validator#validation-errors" target="_blank" rel="noopener noreferrer">Validation errors<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> array.</p> <p>If you need special options for validation (groups, skipping missing properties, etc.) or transforming (groups, excluding prefixes, versions, etc.), you can pass them as global config as <code>validation</code> in createExpressServer method or as a local <code>validate</code> setting for method parameter - <code>@Body({ validate: localOptions })</code>.</p> <p>This technique works not only with <code>@Body</code> but also with <code>@Param</code>, <code>@QueryParam</code>, <code>@BodyParam</code> and other decorators.</p> <h2 id="using-authorization-features"><a href="#using-authorization-features" class="header-anchor">#</a> Using authorization features</h2> <p>Routing-controllers comes with two decorators helping you to organize authorization in your application.</p> <h4 id="authorized-decorator"><a href="#authorized-decorator" class="header-anchor">#</a> <code>@Authorized</code> decorator</h4> <p>To make <code>@Authorized</code> decorator to work you need to setup special routing-controllers options:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer<span class="token punctuation">,</span> Action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">authorizationChecker</span><span class="token punctuation">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">:</span> Action<span class="token punctuation">,</span> roles<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// here you can use request/response objects from action</span>
        <span class="token comment">// also if decorator defines roles it needs to access the action</span>
        <span class="token comment">// you can use them to provide granular access check</span>
        <span class="token comment">// checker must return either boolean (true or false)</span>
        <span class="token comment">// either promise that resolves a boolean value</span>
        <span class="token comment">// demo code:</span>
        <span class="token keyword">const</span> token <span class="token operator">=</span> action<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEntityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findOneByToken</span><span class="token punctuation">(</span>User<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>roles<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">&amp;&amp;</span> roles<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">role</span> <span class="token operator">=&gt;</span> user<span class="token punctuation">.</span>roles<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can use <code>@Authorized</code> on controller actions:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">JsonController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">SomeController</span> <span class="token punctuation">{</span>

    @<span class="token function">Authorized</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/questions&quot;</span><span class="token punctuation">)</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> question<span class="token punctuation">:</span> Question</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Authorized</span><span class="token punctuation">(</span><span class="token string">&quot;POST_MODERATOR&quot;</span><span class="token punctuation">)</span> <span class="token comment">// you can specify roles or array of roles</span>
    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/posts&quot;</span><span class="token punctuation">)</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> post<span class="token punctuation">:</span> Post</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="currentuser-decorator"><a href="#currentuser-decorator" class="header-anchor">#</a> <code>@CurrentUser</code> decorator</h4> <p>To make <code>@CurrentUser</code> decorator to work you need to setup special routing-controllers options:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer<span class="token punctuation">,</span> Action <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">currentUserChecker</span><span class="token punctuation">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">action<span class="token punctuation">:</span> Action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// here you can use request/response objects from action</span>
        <span class="token comment">// you need to provide a user object that will be injected in controller actions</span>
        <span class="token comment">// demo code:</span>
        <span class="token keyword">const</span> token <span class="token operator">=</span> action<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">getEntityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findOneByToken</span><span class="token punctuation">(</span>User<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can use <code>@CurrentUser</code> on controller actions:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">JsonController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuestionController</span> <span class="token punctuation">{</span>

    @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/questions&quot;</span><span class="token punctuation">)</span>
    <span class="token function">all</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">CurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token operator">?</span><span class="token punctuation">:</span> User<span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> question<span class="token punctuation">:</span> Question</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;/questions&quot;</span><span class="token punctuation">)</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">CurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User<span class="token punctuation">,</span> @<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> post<span class="token punctuation">:</span> Post</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>If you mark <code>@CurrentUser</code> as <code>required</code> and currentUserChecker logic will return empty result,
then routing-controllers will throw authorization required error.</p> <h2 id="using-di-container"><a href="#using-di-container" class="header-anchor">#</a> Using DI container</h2> <p><code>routing-controllers</code> supports a DI container out of the box. You can inject your services into your controllers,
middlewares and error handlers. Container must be setup during application bootstrap.
Here is example how to integrate routing-controllers with <a href="https://github.com/typestack/typedi" target="_blank" rel="noopener noreferrer">typedi<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token string">&quot;reflect-metadata&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createExpressServer<span class="token punctuation">,</span> useContainer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typedi&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// its important to set container before any operation you do with routing-controllers,</span>
<span class="token comment">// including importing controllers</span>
<span class="token function">useContainer</span><span class="token punctuation">(</span>Container<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// create and run server</span>
<span class="token function">createExpressServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    controllers<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/controllers/*.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    middlewares<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/middlewares/*.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    interceptors<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname <span class="token operator">+</span> <span class="token string">&quot;/interceptors/*.js&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>That's it, now you can inject your services into your controllers:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UsersController</span> <span class="token punctuation">{</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> userRepository<span class="token punctuation">:</span> UserRepository</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ... controller actions</span>

<span class="token punctuation">}</span>
</code></pre></div><p>For other IoC providers that don't expose a <code>get(xxx)</code> function, you can create an IoC adapter using <code>IocAdapter</code> like so:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// inversify-adapter.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IocAdapter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'routing-controllers'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'inversify'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">InversifyAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">IocAdapter</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span> <span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">private</span> <span class="token keyword">readonly</span> container<span class="token punctuation">:</span> Container</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>someClass<span class="token punctuation">:</span> ClassConstructor<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> action<span class="token operator">?</span><span class="token punctuation">:</span> Action<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> childContainer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">createChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">childContainer</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token constant">API_SYMBOLS</span><span class="token punctuation">.</span>ClientIp<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toConstantValue</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>context<span class="token punctuation">.</span>ip<span class="token punctuation">)</span>
    <span class="token keyword">return</span> childContainer<span class="token punctuation">.</span>resolve<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>someClass<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre></div><p>And then tell Routing Controllers to use it:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// Somewhere in your app startup</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useContainer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'routing-controllers'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'inversify'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> InversifyAdapter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./inversify-adapter.ts'</span>

<span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> inversifyAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InversifyAdapter</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span>
<span class="token function">useContainer</span><span class="token punctuation">(</span>inversifyAdapter<span class="token punctuation">)</span>
</code></pre></div><h2 id="custom-parameter-decorators"><a href="#custom-parameter-decorators" class="header-anchor">#</a> Custom parameter decorators</h2> <p>You can create your own parameter decorators.
Here is simple example how &quot;session user&quot; can be implemented using custom decorators:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createParamDecorator <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;routing-controllers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">UserFromSession</span><span class="token punctuation">(</span><span class="token parameter">options<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> required<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createParamDecorator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        required<span class="token punctuation">:</span> options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>required <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token function-variable function">value</span><span class="token punctuation">:</span> <span class="token parameter">action</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> token <span class="token operator">=</span> action<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;authorization&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> database<span class="token punctuation">.</span><span class="token function">findUserByToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And use it in your controller:</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">JsonController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">QuestionController</span> <span class="token punctuation">{</span>

    @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span><span class="token punctuation">)</span> question<span class="token punctuation">:</span> Question<span class="token punctuation">,</span> @<span class="token function">UserFromSession</span><span class="token punctuation">(</span><span class="token punctuation">{</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> user<span class="token punctuation">:</span> User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// here you'll have user authorized and you can safely save your question</span>
        <span class="token comment">// in the case if user returned your undefined from the database and &quot;required&quot;</span>
        <span class="token comment">// parameter was set, routing-controllers will throw you ParameterRequired error</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre></div><h2 id="decorators-reference"><a href="#decorators-reference" class="header-anchor">#</a> Decorators Reference</h2> <h4 id="controller-decorators"><a href="#controller-decorators" class="header-anchor">#</a> Controller Decorators</h4> <table><thead><tr><th>Signature</th> <th>Example</th> <th>Description</th></tr></thead> <tbody><tr><td><code>@Controller(baseRoute: string)</code></td> <td><code>@Controller(&quot;/users&quot;) class SomeController</code></td> <td>Class that is marked with this decorator is registered as controller and its annotated methods are registered as actions. Base route is used to concatenate it to all controller action routes.</td></tr> <tr><td><code>@JsonController(baseRoute: string)</code></td> <td><code>@JsonController(&quot;/users&quot;) class SomeJsonController</code></td> <td>Class that is marked with this decorator is registered as controller and its annotated methods are registered as actions. Difference between @JsonController and @Controller is that @JsonController automatically converts results returned by controller to json objects (using JSON.parse) and response being sent to a client is sent with application/json content-type. Base route is used to concatenate it to all controller action routes.</td></tr></tbody></table> <h4 id="controller-action-decorators"><a href="#controller-action-decorators" class="header-anchor">#</a> Controller Action Decorators</h4> <table><thead><tr><th>Signature</th> <th>Example</th> <th>Description</th> <th>express.js analogue</th></tr></thead> <tbody><tr><td><code>@Get(route: string\|RegExp)</code></td> <td><code>@Get(&quot;/users&quot;) all()</code></td> <td>Methods marked with this decorator will register a request made with GET HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.get(&quot;/users&quot;, all)</code></td></tr> <tr><td><code>@Post(route: string\|RegExp)</code></td> <td><code>@Post(&quot;/users&quot;) save()</code></td> <td>Methods marked with this decorator will register a request made with POST HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.post(&quot;/users&quot;, save)</code></td></tr> <tr><td><code>@Put(route: string\|RegExp)</code></td> <td><code>@Put(&quot;/users/:id&quot;) update()</code></td> <td>Methods marked with this decorator will register a request made with PUT HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.put(&quot;/users/:id&quot;, update)</code></td></tr> <tr><td><code>@Patch(route: string\|RegExp)</code></td> <td><code>@Patch(&quot;/users/:id&quot;) patch()</code></td> <td>Methods marked with this decorator will register a request made with PATCH HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.patch(&quot;/users/:id&quot;, patch)</code></td></tr> <tr><td><code>@Delete(route: string\|RegExp)</code></td> <td><code>@Delete(&quot;/users/:id&quot;) delete()</code></td> <td>Methods marked with this decorator will register a request made with DELETE HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.delete(&quot;/users/:id&quot;, delete)</code></td></tr> <tr><td><code>@Head(route: string\|RegExp)</code></td> <td><code>@Head(&quot;/users/:id&quot;) head()</code></td> <td>Methods marked with this decorator will register a request made with HEAD HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.head(&quot;/users/:id&quot;, head)</code></td></tr> <tr><td><code>@All(route: string\|RegExp)</code></td> <td><code>@All(&quot;/users/me&quot;) rewrite()</code></td> <td>Methods marked with this decorator will register a request made with any HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.all(&quot;/users/me&quot;, rewrite)</code></td></tr> <tr><td><code>@Method(methodName: string, route: string\|RegExp)</code></td> <td><code>@Method(&quot;move&quot;, &quot;/users/:id&quot;) move()</code></td> <td>Methods marked with this decorator will register a request made with given <code>methodName</code> HTTP Method to a given route. In action options you can specify if action should response json or regular text response.</td> <td><code>app.move(&quot;/users/:id&quot;, move)</code></td></tr></tbody></table> <h4 id="method-parameter-decorators"><a href="#method-parameter-decorators" class="header-anchor">#</a> Method Parameter Decorators</h4> <table><thead><tr><th>Signature</th> <th>Example</th> <th>Description</th> <th>express.js analogue</th></tr></thead> <tbody><tr><td><code>@Req()</code></td> <td><code>getAll(@Req() request: Request)</code></td> <td>Injects a Request object.</td> <td><code>function (request, response)</code></td></tr> <tr><td><code>@Res()</code></td> <td><code>getAll(@Res() response: Response)</code></td> <td>Injects a Response object.</td> <td><code>function (request, response)</code></td></tr> <tr><td><code>@Ctx()</code></td> <td><code>getAll(@Ctx() context: Context)</code></td> <td>Injects a Context object (koa-specific)</td> <td><code>function (ctx)</code> (koa-analogue)</td></tr> <tr><td><code>@Param(name: string, options?: ParamOptions)</code></td> <td><code>get(@Param(&quot;id&quot;) id: number)</code></td> <td>Injects a router parameter.</td> <td><code>request.params.id</code></td></tr> <tr><td><code>@Params()</code></td> <td><code>get(@Params() params: any)</code></td> <td>Injects all router parameters.</td> <td><code>request.params</code></td></tr> <tr><td><code>@QueryParam(name: string, options?: ParamOptions)</code></td> <td><code>get(@QueryParam(&quot;id&quot;) id: number)</code></td> <td>Injects a query string parameter.</td> <td><code>request.query.id</code></td></tr> <tr><td><code>@QueryParams()</code></td> <td><code>get(@QueryParams() params: any)</code></td> <td>Injects all query parameters.</td> <td><code>request.query</code></td></tr> <tr><td><code>@HeaderParam(name: string, options?: ParamOptions)</code></td> <td><code>get(@HeaderParam(&quot;token&quot;) token: string)</code></td> <td>Injects a specific request headers.</td> <td><code>request.headers.token</code></td></tr> <tr><td><code>@HeaderParams()</code></td> <td><code>get(@HeaderParams() params: any)</code></td> <td>Injects all request headers.</td> <td><code>request.headers</code></td></tr> <tr><td><code>@CookieParam(name: string, options?: ParamOptions)</code></td> <td><code>get(@CookieParam(&quot;username&quot;) username: string)</code></td> <td>Injects a cookie parameter.</td> <td><code>request.cookie(&quot;username&quot;)</code></td></tr> <tr><td><code>@CookieParams()</code></td> <td><code>get(@CookieParams() params: any)</code></td> <td>Injects all cookies.</td> <td><code>request.cookies</code></td></tr> <tr><td><code>@Session()</code></td> <td><code>get(@Session() session: any)</code></td> <td>Injects the whole session object.</td> <td><code>request.session</code></td></tr> <tr><td><code>@SessionParam(name: string)</code></td> <td><code>get(@SessionParam(&quot;user&quot;) user: User)</code></td> <td>Injects an object from session property.</td> <td><code>request.session.user</code></td></tr> <tr><td><code>@State(name?: string)</code></td> <td><code>get(@State() session: StateType)</code></td> <td>Injects an object from the state (or the whole state).</td> <td><code>ctx.state</code> (koa-analogue)</td></tr> <tr><td><code>@Body(options?: BodyOptions)</code></td> <td><code>post(@Body() body: any)</code></td> <td>Injects a body. In parameter options you can specify body parser middleware options.</td> <td><code>request.body</code></td></tr> <tr><td><code>@BodyParam(name: string, options?: ParamOptions)</code></td> <td><code>post(@BodyParam(&quot;name&quot;) name: string)</code></td> <td>Injects a body parameter.</td> <td><code>request.body.name</code></td></tr> <tr><td><code>@UploadedFile(name: string, options?: UploadOptions)</code></td> <td><code>post(@UploadedFile(&quot;filename&quot;) file: any)</code></td> <td>Injects uploaded file from the response. In parameter options you can specify underlying uploader middleware options.</td> <td><code>request.file.file</code> (using multer)</td></tr> <tr><td><code>@UploadedFiles(name: string, options?: UploadOptions)</code></td> <td><code>post(@UploadedFiles(&quot;filename&quot;) files: any[])</code></td> <td>Injects all uploaded files from the response. In parameter options you can specify underlying uploader middleware options.</td> <td><code>request.files</code> (using multer)</td></tr></tbody></table> <h4 id="middleware-and-interceptor-decorators"><a href="#middleware-and-interceptor-decorators" class="header-anchor">#</a> Middleware and Interceptor Decorators</h4> <table><thead><tr><th>Signature</th> <th>Example</th> <th>Description</th></tr></thead> <tbody><tr><td><code>@Middleware({ type: &quot;before&quot;\|&quot;after&quot; })</code></td> <td><code>@Middleware({ type: &quot;before&quot; }) class SomeMiddleware</code></td> <td>Registers a global middleware.</td></tr> <tr><td><code>@UseBefore()</code></td> <td><code>@UseBefore(CompressionMiddleware)</code></td> <td>Uses given middleware before action is being executed.</td></tr> <tr><td><code>@UseAfter()</code></td> <td><code>@UseAfter(CompressionMiddleware)</code></td> <td>Uses given middleware after action is being executed.</td></tr> <tr><td><code>@Interceptor()</code></td> <td><code>@Interceptor() class SomeInterceptor</code></td> <td>Registers a global interceptor.</td></tr> <tr><td><code>@UseInterceptor()</code></td> <td><code>@UseInterceptor(BadWordsInterceptor)</code></td> <td>Intercepts result of the given controller/action and replaces some values of it.</td></tr></tbody></table> <h4 id="other-decorators"><a href="#other-decorators" class="header-anchor">#</a> Other Decorators</h4> <table><thead><tr><th>Signature</th> <th>Example</th> <th>Description</th></tr></thead> <tbody><tr><td><code>@Authorized(roles?: string\|string[])</code></td> <td><code>@Authorized(&quot;SUPER_ADMIN&quot;)</code> get()</td> <td>Checks if user is authorized and has given roles on a given route. <code>authorizationChecker</code> should be defined in routing-controllers options.</td></tr> <tr><td><code>@CurrentUser(options?: { required?: boolean })</code></td> <td>get(@CurrentUser({ required: true }) user: User)</td> <td>Injects currently authorized user. <code>currentUserChecker</code> should be defined in routing-controllers options.</td></tr> <tr><td><code>@Header(headerName: string, headerValue: string)</code></td> <td><code>@Header(&quot;Cache-Control&quot;, &quot;private&quot;)</code> get()</td> <td>Allows to explicitly set any HTTP header returned in the response.</td></tr> <tr><td><code>@ContentType(contentType: string)</code></td> <td><code>@ContentType(&quot;text/csv&quot;)</code> get()</td> <td>Allows to explicitly set HTTP Content-Type returned in the response.</td></tr> <tr><td><code>@Location(url: string)</code></td> <td><code>@Location(&quot;http://github.com&quot;)</code> get()</td> <td>Allows to explicitly set HTTP Location header returned in the response.</td></tr> <tr><td><code>@Redirect(url: string)</code></td> <td><code>@Redirect(&quot;http://github.com&quot;)</code> get()</td> <td>Allows to explicitly set HTTP Redirect header returned in the response.</td></tr> <tr><td><code>@HttpCode(code: number)</code></td> <td><code>@HttpCode(201)</code> post()</td> <td>Allows to explicitly set HTTP code to be returned in the response.</td></tr> <tr><td><code>@OnNull(codeOrError: number\|Error)</code></td> <td><code>@OnNull(201)</code> post()</td> <td>Sets a given HTTP code when controller action returned null.</td></tr> <tr><td><code>@OnUndefined(codeOrError: number\|Error)</code></td> <td><code>@OnUndefined(201)</code> post()</td> <td>Sets a given HTTP code when controller action returned undefined.</td></tr> <tr><td><code>@ResponseClassTransformOptions(options: ClassTransformOptions)</code></td> <td><code>@ResponseClassTransformOptions({/*...*/})</code> get()</td> <td>Sets options to be passed to class-transformer when it used for classToPlain a response result.</td></tr> <tr><td><code>@Render(template: string)</code></td> <td><code>@Render(&quot;user-list.html&quot;)</code> get()</td> <td>Renders a given html template. Data returned by a controller serve as template variables.</td></tr></tbody></table> <h2 id="samples"><a href="#samples" class="header-anchor">#</a> Samples</h2> <ul><li>Take a look on <a href="https://github.com/typestack/routing-controllers-express-demo" target="_blank" rel="noopener noreferrer">routing-controllers with express<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is using routing-controllers.</li> <li>Take a look on <a href="https://github.com/typestack/routing-controllers-koa-demo" target="_blank" rel="noopener noreferrer">routing-controllers with koa<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is using routing-controllers.</li> <li>Take a look on <a href="https://github.com/typestack/routing-controllers-angular2-demo" target="_blank" rel="noopener noreferrer">routing-controllers with angular 2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is using routing-controllers.</li> <li>Take a look on <a href="https://github.com/swimlane/node-microservice-demo" target="_blank" rel="noopener noreferrer">node-microservice-demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which is using routing-controllers.</li> <li>Take a look on samples in <a href="https://github.com/typestack/routing-controllers/tree/master/sample" target="_blank" rel="noopener noreferrer">./sample<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for more examples
of usage.</li></ul> <h2 id="release-notes"><a href="#release-notes" class="header-anchor">#</a> Release notes</h2> <p>See information about breaking changes and release notes <a href="/server/nodejs/CHANGELOG.html">here</a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ruanjq/windhome/edit/master/docs/server/nodejs/routingControllers.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最近修改::</span> <span class="time">2020-8-19 6:02:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/server/nodejs/request.html" class="prev"> node 转发接口请求</a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.5d5e6ed3.js" defer></script><script src="/assets/js/2.4e5ce663.js" defer></script><script src="/assets/js/55.15ffc253.js" defer></script>
  </body>
</html>
